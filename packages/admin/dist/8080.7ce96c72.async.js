(self.webpackChunk_vanblog_admin=self.webpackChunk_vanblog_admin||[]).push([[8080],{58080:function(ht,v,r){"use strict";r.r(v),r.d(v,{diagram:function(){return Tt}});var a=r(56492),Q=r(67058),P=r(82106),i=r(92561),X=r(56647),$=r(33125),ut=r(27856),ft=r(27484),bt=r(67925),Ct=r(91089),yt=r(31898),pt=r(61939);const C="rect",R="rectWithTitle",Z="start",F="end",m="divider",q="roundedWithTitle",tt="note",et="noteGroup",T="statediagram",st=`${T}-state`,B="transition",ot="note",nt=`${B} note-edge`,ct=`${T}-${ot}`,it=`${T}-cluster`,rt=`${T}-cluster-alt`,G="parent",N="note",lt="state",O="----",at=`${O}${N}`,U=`${O}${G}`,W="fill:none",w="fill: #333",K="c",H="text",k="normal";let y={},E=0;const dt=function(t){const n=Object.keys(t);for(const s of n)t[s]},_t=function(t,n){i.l.trace("Extracting classes"),n.db.clear();try{return n.parser.parse(t),n.db.extract(n.db.getRootDocV2()),n.db.getClasses()}catch(s){return s}};function Et(t){return t==null?"":t.classes?t.classes.join(" "):""}function M(t="",n=0,s="",c=O){const l=s!==null&&s.length>0?`${c}${s}`:"";return`${lt}-${t}${l}-${n}`}const u=(t,n,s,c,l,d)=>{const e=s.id,f=Et(c[e]);if(e!=="root"){let A=C;s.start===!0&&(A=Z),s.start===!1&&(A=F),s.type!==a.a&&(A=s.type),y[e]||(y[e]={id:e,shape:A,description:i.e.sanitizeText(e,(0,i.g)()),classes:`${f} ${st}`});const o=y[e];s.description&&(Array.isArray(o.description)?(o.shape=R,o.description.push(s.description)):o.description.length>0?(o.shape=R,o.description===e?o.description=[s.description]:o.description=[o.description,s.description]):(o.shape=C,o.description=s.description),o.description=i.e.sanitizeTextOrArray(o.description,(0,i.g)())),o.description.length===1&&o.shape===R&&(o.shape=C),!o.type&&s.doc&&(i.l.info("Setting cluster for ",e,L(s)),o.type="group",o.dir=L(s),o.shape=s.type===a.b?m:q,o.classes=o.classes+" "+it+" "+(d?rt:""));const h={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:e,dir:o.dir,domId:M(e,E),type:o.type,padding:15};if(h.centerLabel=!0,s.note){const S={labelStyle:"",shape:tt,labelText:s.note.text,classes:ct,style:"",id:e+at+"-"+E,domId:M(e,E,N),type:o.type,padding:15},p={labelStyle:"",shape:et,labelText:s.note.text,classes:o.classes,style:"",id:e+U,domId:M(e,E,G),type:"group",padding:0};E++;const _=e+U;t.setNode(_,p),t.setNode(S.id,S),t.setNode(e,h),t.setParent(e,_),t.setParent(S.id,_);let g=e,D=S.id;s.note.position==="left of"&&(g=S.id,D=e),t.setEdge(g,D,{arrowhead:"none",arrowType:"",style:W,labelStyle:"",classes:nt,arrowheadStyle:w,labelpos:K,labelType:H,thickness:k})}else t.setNode(e,h)}n&&n.id!=="root"&&(i.l.trace("Setting node ",e," to be child of its parent ",n.id),t.setParent(e,n.id)),s.doc&&(i.l.trace("Adding nodes children "),St(t,s,s.doc,c,l,!d))},St=(t,n,s,c,l,d)=>{i.l.trace("items",s),s.forEach(e=>{switch(e.stmt){case a.c:u(t,n,e,c,l,d);break;case a.a:u(t,n,e,c,l,d);break;case a.S:{u(t,n,e.state1,c,l,d),u(t,n,e.state2,c,l,d);const f={id:"edge"+E,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:W,labelStyle:"",label:i.e.sanitizeText(e.description,(0,i.g)()),arrowheadStyle:w,labelpos:K,labelType:H,thickness:k,classes:B};t.setEdge(e.state1.id,e.state2.id,f,E),E++}break}})},L=(t,n=a.e)=>{let s=n;if(t.doc)for(let c=0;c<t.doc.length;c++){const l=t.doc[c];l.stmt==="dir"&&(s=l.value)}return s},Dt={setConf:dt,getClasses:_t,draw:function(t,n,s,c){i.l.info("Drawing state diagram (v2)",n),y={};let l=c.db.getDirection();l===void 0&&(l=a.D);const{securityLevel:d,state:e}=(0,i.g)(),f=e.nodeSpacing||50,A=e.rankSpacing||50;i.l.info(c.db.getRootDocV2()),c.db.extract(c.db.getRootDocV2()),i.l.info(c.db.getRootDocV2());const o=c.db.getStates(),h=new Q.k({multigraph:!0,compound:!0}).setGraph({rankdir:L(c.db.getRootDocV2()),nodesep:f,ranksep:A,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});u(h,void 0,c.db.getRootDocV2(),o,c.db,!0);let S;d==="sandbox"&&(S=(0,P.Ys)("#i"+n));const p=d==="sandbox"?(0,P.Ys)(S.nodes()[0].contentDocument.body):(0,P.Ys)("body"),_=p.select(`[id="${n}"]`),g=p.select("#"+n+" g");(0,X.r)(g,h,["barb"],T,n);const D=8;$.u.insertTitle(_,"statediagramTitleText",e.titleTopMargin,c.db.getDiagramTitle());const j=_.node().getBBox(),V=j.width+D*2,Y=j.height+D*2;_.attr("class",T);const z=_.node().getBBox();(0,$.k)(_,Y,V,e.useMaxWidth);const I=`${z.x-D} ${z.y-D} ${V} ${Y}`;i.l.debug(`viewBox ${I}`),_.attr("viewBox",I);const At=document.querySelectorAll('[id="'+n+'"] .edgeLabel .label');for(const x of At){const J=x.getBBox(),b=document.createElementNS("http://www.w3.org/2000/svg",C);b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("width",J.width),b.setAttribute("height",J.height),x.insertBefore(b,x.firstChild)}}},Tt={parser:a.p,db:a.d,renderer:Dt,styles:a.s,init:t=>{t.state||(t.state={}),t.state.arrowMarkerAbsolute=t.arrowMarkerAbsolute,a.d.clear()}}}}]);
